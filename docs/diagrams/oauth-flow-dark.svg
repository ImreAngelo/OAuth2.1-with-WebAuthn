<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="988.2531186120125" height="948.436753782818"><desc>title%20OAuth%202.1%20flow%20%0A%23%20with%20WebAuthn%20login%0A%0AClient-%3EClient%3A%20Generate%20PKCE%5Cnverifier%20%2B%20challenge%20%0AClient-%3EBrowser%3A%20Open%0A%0Aactivate%20Client%0A%23space%20-2%0Anote%20over%20Client%3A%20Start%20listening%20on%20%7Bredirect_uri%7D%0A%0A%23Client-%3EClient%3A%20Start%20listening%20on%20%7Bredirect_uri%7D%0A%0Aspace%20-10%0ABrowser-%3EAuth%3AGET%20%2Fauthorize%3Fresponse_type%3Dcode%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20redirect_uri%3D%7Bredirect_uri%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20challenge%3D%7Bchallenge%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20state%3D%7Bstate%7D%0A%0Aactivate%20Auth%0Anote%20over%20Auth%3A%20Begin%20OAuth%20session%0A%0A%23%20Auth-%3EAuth%3A%20(optional)%20SSR%5Cnto%20include%20login%5Cnoptions%2Fwebauthn%0A%23space%20-2.5%0AAuth-%3EAuth%20%3A%20Save%20request%20parameters%5Cnidentified%20by%20the%20session%20ID%0A%0A%0ABrowser%3C-Auth%3A%20200%20ok%2C%20set-cookie%3A%20%7Bsession%20ID%7D%0A%23%5Cn%2F%2Foptional%3A%2F%2F%20include%20webauthn%20login%20options%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20or%20browser%20must%20fetch%20these%20%0A%23deactivate%20Auth%0A%0Aactivate%20Browser%0Anote%20over%20Browser%2C%20Auth%3A%20User%20authenticates%20via%20selected%5Cnmethod%3A%20WebAuthn%2C%20password%20etc.%0A%23%20Browser-%3EBrowser%3A%20User%20authenticates%20via%20selected%5Cnmethod%3A%20WebAuthn%2C%20password%20etc.%0A%23Browser-%3EBrowser%3A%20User%20authenticates%20with%20WebAuthn%5Cnlocally%2C%20e.g.%20using%20pin%20or%20biometrics%20%20%0ABrowser-%3EAuth%3A%20POST%20%2F%7Bmethod%7D%2Flogin%2Fverify%0Adeactivate%20Browser%0A%0A%23activate%20Auth%0AAuth-%3EAuth%3A%20Verify%20authentication%20and%5Cngenerate%20auth%20code%20linked%20to%5Cnsession%20ID%0AAuth-%3EBrowser%3A%20301%20redirect%20%7Bredirect_uri%7D%3Fcode%3D%7Bcode%7D%0A%23deactivate%20Auth%0A%0Aspace%20-3%0ABrowser-%3EClient%3A%20GET%20%7Bredirect_uri%7D%3Fcode%3D%7Bcode%7D%20%0Adeactivate%20Client%0A%0AClient-%3EAuth%3A%20POST%20%2Foauth%2Ftoken%20with%20%7Bcode%7D%20and%20PKCE%20%7Bverifier%7D%0A%0AAuth-%3EAuth%3A%20Verify%20challenge%20%3D%20S256(verifier)%20%0A%0A%0A%0AAuth-%3EClient%3A%20200%20ok%2C%20send%20%7Baccess%20token%7D%20and%20%7Brefresh%20token%7D%0Adeactivate%20Auth%0A%0A%0A%23%20database%20Database%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="#0d1117" stroke="none" x="0" y="0" width="988" height="948"/></g><g/><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 137.17948639412108 95.73914152281817 L 137.17948639412108 948.436753782818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 408.0919011008309 95.73914152281817 L 408.0919011008309 948.436753782818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 738.3376459619597 95.73914152281817 L 738.3376459619597 948.436753782818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 100.75579005068163 51.63409261281818 L 173.60318273756053 51.63409261281818 L 173.60318273756053 95.73914152281817 L 100.75579005068163 95.73914152281817 L 100.75579005068163 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="118.47948563118163" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 363.54320475739144 51.63409261281818 L 452.6405974442704 51.63409261281818 L 452.6405974442704 95.73914152281817 L 363.54320475739144 95.73914152281817 L 363.54320475739144 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="381.26690033789146" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 705.5639501907248 51.63409261281818 L 771.1113417331945 51.63409261281818 L 771.1113417331945 95.73914152281817 L 705.5639501907248 95.73914152281817 L 705.5639501907248 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="723.2876457712248" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Auth</text></g></g><g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 129.0118847441211 232.95484924281817 L 145.34708804412108 232.95484924281817 L 145.34708804412108 732.8120702228181 L 129.0118847441211 732.8120702228181 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 730.1700443119596 250.92357287281814 L 746.5052476119597 250.92357287281814 L 746.5052476119597 891.2635422328179 L 730.1700443119596 891.2635422328179 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 399.9242994508309 442.0454514828182 L 416.2595027508309 442.0454514828182 L 416.2595027508309 566.1929965628182 L 399.9242994508309 566.1929965628182 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="white" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.3749988079071" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OAuth 2.1 flow </text></g><g><rect fill="#0d1117" stroke="none" x="156.50947696578777" y="128.40954812281817" width="109.81722511353516" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="156.50947696578777" y="144.74475142281818" width="132.15056099" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="158.95975746078776" y="143.11123109281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate PKCE</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="158.95975746078776" y="159.44643439281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">verifier + challenge </text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 137.17948639412108 165.98051571281817 L 202.52029959412107 165.98051571281817 L 202.52029959412107 187.21628000281817 L 150.62880377778777 187.21628000281817" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(137.17948639412108,187.21628000281817) translate(-137.17948639412108,-187.21628000281817)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 150.79215581078776 180.40994529448483 L 137.17948639412108 187.21628000281817 L 150.79215581078776 194.0226147111515 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="256.3775476651225" y="211.71908495281818" width="40.683893814707034" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="258.8278281601225" y="226.42076792281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Open</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 145.34708804412108 232.95484924281817 L 394.64258371716426 232.95484924281817" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(408.0919011008309,232.95484924281817) translate(-408.0919011008309,-232.95484924281817)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 394.47923168416423 226.14851453448483 L 408.0919011008309 232.95484924281817 L 394.47923168416423 239.7611839511515 Z"/></g></g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 16.335203299999996 257.45765419281815 L 243.32208651824217 257.45765419281815 L 258.0237694882422 272.15933716281813 L 258.0237694882422 295.02862178281816 L 16.335203299999996 295.02862178281816 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 243.32208651824217 257.45765419281815 L 243.32208651824217 272.15933716281813 L 258.0237694882422 272.15933716281813" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="39.20448791999999" y="280.3269388128181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Start listening on {redirect_uri}</text></g><g><rect fill="#0d1117" stroke="none" x="431.50569249749753" y="180.68219868281813" width="247.63389839234375" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="431.50569249749753" y="197.01740198281811" width="275.2505670935156" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="431.50569249749753" y="213.3526052828181" width="254.18390144410156" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="431.50569249749753" y="229.6878085828181" width="192.38389839234375" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.95597299249755" y="195.3838816528181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET /authorize?response_type=code</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.95597299249755" y="211.7190849528181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          redirect_uri={redirect_uri}</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.95597299249755" y="228.05428825281808" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          challenge={challenge}</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.95597299249755" y="244.38949155281807" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          state={state}</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 408.0919011008309 250.92357287281814 L 716.720726928293 250.92357287281814" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(730.1700443119596,250.92357287281814) translate(-730.1700443119596,-250.92357287281814)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 716.5573748952929 244.1172381644848 L 730.1700443119596 250.92357287281814 L 716.5573748952929 257.72990758115145 Z"/></g></g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 647.151693785197 275.42637782281815 L 814.8219151687225 275.42637782281815 L 829.5235981387225 290.12806079281813 L 829.5235981387225 312.99734541281816 L 647.151693785197 312.99734541281816 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 814.8219151687225 275.42637782281815 L 814.8219151687225 290.12806079281813 L 829.5235981387225 290.12806079281813" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="670.020978405197" y="298.2956624428181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Begin OAuth session</text></g><g><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="337.5001503628182" width="169.13389839234375" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="353.8353536628182" width="179.73388923707031" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="352.2018333328182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Save request parameters</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="368.5370366328182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">identified by the session ID</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 746.5052476119597 375.07111795281816 L 811.8460608119597 375.07111795281816 L 811.8460608119597 396.3068822428182 L 759.9545649956264 396.3068822428182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(746.5052476119597,396.3068822428182) translate(-746.5052476119597,-396.3068822428182)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 760.1179170286264 389.50054753448484 L 746.5052476119597 396.3068822428182 L 760.1179170286264 403.1132169511515 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="468.30615811360474" y="420.80968719281816" width="209.8172327429297" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.75643860860475" y="435.51137016281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 ok, set-cookie: {session ID}</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 730.1700443119596 442.0454514828182 L 429.70882013449756 442.0454514828182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(416.2595027508309,442.0454514828182) translate(-416.2595027508309,-442.0454514828182)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 429.8721721674976 435.23911677448484 L 416.2595027508309 442.0454514828182 L 429.8721721674976 448.8517861911515 Z"/></g></g><path fill="#0d1117" stroke="white" paint-order="fill stroke markers" d=" M 393.39021813083093 466.5482564328182 L 738.3376459619598 466.5482564328182 L 753.0393289319597 481.2499394028182 L 753.0393289319597 520.4544273228182 L 393.39021813083093 520.4544273228182 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 738.3376459619598 466.5482564328182 L 738.3376459619598 481.2499394028182 L 753.0393289319597 481.2499394028182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="461.53977524800905" y="489.4175410528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User authenticates via selected</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="461.53977524800905" y="505.7527443528182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">method: WebAuthn, password etc.</text></g><g><rect fill="#0d1117" stroke="none" x="480.5061579228699" y="544.9572322728181" width="185.41722358765625" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="482.9564384178699" y="559.6589152428181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /{method}/login/verify</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 416.2595027508309 566.1929965628182 L 716.720726928293 566.1929965628182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(730.1700443119596,566.1929965628182) translate(-730.1700443119596,-566.1929965628182)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 716.5573748952929 559.3866618544848 L 730.1700443119596 566.1929965628182 L 716.5573748952929 572.9993312711515 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="590.6958015128182" width="165.1005579382422" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="607.0310048128182" width="189.50056709351563" height="21.23576429"/><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="623.3662081128182" width="73.20056404175781" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="605.3974844828182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify authentication and</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="621.7326877828182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">generate auth code linked to</text><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="638.0678910828182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">session ID</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 746.5052476119597 644.6019724028182 L 811.8460608119597 644.6019724028182 L 811.8460608119597 665.8377366928182 L 759.9545649956264 665.8377366928182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(746.5052476119597,665.8377366928182) translate(-746.5052476119597,-665.8377366928182)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 760.1179170286264 659.0314019844849 L 746.5052476119597 665.8377366928182 L 760.1179170286264 672.6440714011516 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="439.6306920206604" y="690.3405416428182" width="259.0005670935156" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="442.0809725156604" y="705.0422246128181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">301 redirect {redirect_uri}?code={code}</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 730.1700443119596 711.5763059328182 L 421.54121848449756 711.5763059328182" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(408.0919011008309,711.5763059328182) translate(-408.0919011008309,-711.5763059328182)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 421.7045705174976 704.7699712244848 L 408.0919011008309 711.5763059328182 L 421.7045705174976 718.3826406411515 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="168.76087944078782" y="711.5763059328181" width="215.91722358765625" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="171.2111599357878" y="726.277988902818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET {redirect_uri}?code={code} </text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 408.0919011008309 732.8120702228181 L 158.79640542778776 732.8120702228181" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(145.34708804412108,732.8120702228181) translate(-145.34708804412108,-732.8120702228181)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 158.95975746078776 726.0057355144847 L 145.34708804412108 732.8120702228181 L 158.95975746078776 739.6184049311514 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="266.13281672907306" y="757.314875172818" width="335.08388008179685" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="268.5830972240731" y="772.016558142818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /oauth/token with {code} and PKCE {verifier}</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 137.17948639412108 778.550639462818 L 716.720726928293 778.550639462818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(730.1700443119596,778.550639462818) translate(-730.1700443119596,-778.550639462818)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 716.5573748952929 771.7443047544847 L 730.1700443119596 778.550639462818 L 716.5573748952929 785.3569741711514 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="765.8352381836264" y="803.053444412818" width="216.70056404175781" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.2855186786264" y="817.7551273828179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verify challenge = S256(verifier) </text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 746.5052476119597 824.289208702818 L 811.8460608119597 824.289208702818 L 811.8460608119597 845.524972992818 L 759.9545649956264 845.524972992818" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(746.5052476119597,845.524972992818) translate(-746.5052476119597,-845.524972992818)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 760.1179170286264 838.7186382844847 L 746.5052476119597 845.524972992818 L 760.1179170286264 852.3313077011513 Z"/></g></g><g><rect fill="#0d1117" stroke="none" x="275.8994840951009" y="870.0277779428179" width="315.55055488648435" height="21.23576429"/><text fill="white" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="278.3497645901009" y="884.7294609128179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">200 ok, send {access token} and {refresh token}</text></g><g><path fill="none" stroke="white" paint-order="fill stroke markers" d=" M 730.1700443119596 891.2635422328179 L 150.62880377778777 891.2635422328179" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(137.17948639412108,891.2635422328179) translate(-137.17948639412108,-891.2635422328179)"><path fill="white" stroke="none" paint-order="stroke fill markers" d=" M 150.79215581078776 884.4572075244846 L 137.17948639412108 891.2635422328179 L 150.79215581078776 898.0698769411513 Z"/></g></g></g><g/><g/><g/></g></svg>